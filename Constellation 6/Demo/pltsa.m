function fig_handle = pltsimpr(auto_mode)

% Example function to plot simulated S/A effects on PR measurements
% The simulated data are loaded from the file demoplt1.mat
% which is generated by the example function demoplt1.m
% Input:
%   auto_mode = optional flag (only include when in auto mode)

% Written by: Jimmy LaMance 9/5/97
% Copyright (c) 1998 by Constell, Inc.

% load in the data
load demoplt1

if nargin < 1,
  % Get the screen size in pixels to use for location of plots
  set(0,'units','pixels');
  screen_size = get(0,'screensize');
  y_max = screen_size(2) + screen_size(4) - 60;
  x_max = screen_size(1) + screen_size(3) - 50;
  x_step = 110;
  y_step = 60 + y_max;
  
  % set the figure colors to be black background like Matlab 4
  colordef none                                

  % generate the position error figure
  fig_handle = figure('color','black', ...
   'position',[30 50 x_max-30 y_max-50],  ...
   'NumberTitle','off', ...
   'Name','Simulated SA Errors', ...
   'Tag','fign');

end;

% only plot 3 satellites 
I_svs_plot = prn_base(1:4);

I_plot = [];
for i = 1:size(I_svs_plot,1)
  I = find(prn_base == I_svs_plot(i));
  I_plot = [I_plot; I];
end % for i = 1:size(I_svs_plot,1)

fig_title_cell={'Simulated SA Errors';};
x = t_pr_base(I_plot,:);
y = pr_sa_errb(I_plot);
prn = prn_base(I_plot);
axis_label_cell = {''; 'SA (m)';'Selective Availability Error';};

legend_cell = {''};

descriptive_text_cell = ...
 {'The Constellation Toolbox provides the ability to simulate Selective Availability (SA).'; ...
  'SA is the intentional degradation of the GPS satellite signals to deny the full';
  'accuracy to unauthorized (non-military) users.  SA is accomplished by providing';
  'the user with false information about the satellite clock and orbit.  The result';
  'of SA is apparent errors in the PR measurements.  A sample of simulated SA data';
  'for 4 satellites is shown below.'};

if nargin < 1,
  textwin2(fig_title_cell,x,y,prn,axis_label_cell,legend_cell, ...
      descriptive_text_cell,1);

  % Determine the location for the plot in upper right corner
  x_min = x_max / 10;
  y_min = y_max / 10;

  % set the figure position
  set(fig_handle,'position',[x_min y_min x_max/1.25 y_max/1.25]);
else,
  fig_handle = gcf;
  textwin2(fig_title_cell,x,y,prn,axis_label_cell,legend_cell, ...
      descriptive_text_cell);
end;


% end of PLTSA
